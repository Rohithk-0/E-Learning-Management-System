{% extends 'base.html' %}
{% block title %}Student Progress Report{% endblock %}
{% block content %}
<h2 class="mb-4">ðŸ“Š Student Progress Report</h2>
<a href="{% url 'export_progress_excel' %}" class="btn btn-success mb-3">
    <i class="bi bi-file-earmark-excel"></i> Export as Excel
</a>


<div class="table-responsive">
    <table class="table table-bordered table-hover align-middle text-center">
        <thead class="table-dark">
            <tr>
                <th>Student</th>
                {% for course in courses %}
                    <th>{{ course.title }}</th>
                {% endfor %}
            </tr>
        </thead>
        <tbody>
            {% for row in report_data %}
            <tr>
                <td><strong>{{ row.student }}</strong></td>
                {% for p in row.progress %}
                    <td>
                        <div class="progress" style="height: 20px;">
                            <div class="progress-bar bg-info" role="progressbar"
                                 style="width: {{ p.percent }}%;" aria-valuenow="{{ p.percent }}"
                                 aria-valuemin="0" aria-valuemax="100">
                                {{ p.percent }}%
                            </div>
                        </div>
                    </td>
                {% endfor %}
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
