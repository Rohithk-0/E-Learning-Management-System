{% load static %}
<!doctype html>
<html lang="en">
  <head>
    <title>{% block title %}Dashboard{% endblock %}</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700,800,900" rel="stylesheet">

    <!-- FontAwesome & Bootstrap -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <link rel="stylesheet" href="{% static 'css/style.css' %}">
  </head>
  <body>
    

    <div class="wrapper d-flex align-items-stretch">
      <!-- Sidebar -->
      <nav id="sidebar">
        <div class="p-4 pt-5">
      
          <div class="text-center py-4 border-bottom">
            
          
            <!-- Profile Picture -->
            <div class="mt-3">
              {% if user.is_student and user.studentprofile.profile_pic %}
                <img src="{{ user.studentprofile.profile_pic.url }}" class="rounded-circle shadow mb-2" width="80" height="80" alt="Student Profile">
              {% elif user.is_trainer and user.trainerprofile.profile_pic %}
                <img src="{{ user.trainerprofile.profile_pic.url }}" class="rounded-circle shadow mb-2" width="80" height="80" alt="Trainer Profile">
              {% else %}
                <i class="bi bi-person-circle text-secondary mb-2" style="font-size: 3rem;"></i>
              {% endif %}
          
              <!-- Username -->
              <div class="fw-semibold small text-dark">
                {{ user.username }}
              </div>
            </div>
          </div>
          
          

      
          <!-- Role-Based Navigation -->
          <ul class="nav flex-column px-3 py-3">
            {% if user.role == 'student' %}
              <li class="nav-item"><a class="nav-link" href="{% url 'browse_courses' %}"><i class="bi bi-bag-plus"></i> Browse Courses</a></li>
              <li class="nav-item"><a class="nav-link" href="{% url 'my_purchases' %}"><i class="bi bi-cart-check"></i> My Purchases</a></li>
              <li class="nav-item"><a class="nav-link" href="{% url 'top_rated_videos' %}"><i class="bi bi-star-half"></i> Top Rated</a></li>

              <li class="nav-item">
                <a class="nav-link" href="{% url 'trainer_list' %}">
                  <i class="bi bi-person-circle"></i> Trainers
                </a>
              </li>
              
              
              
            
              <li class="nav-item"><a class="nav-link" href="{% url 'student_quiz_dashboard' %}"><i class="bi bi-patch-question"></i> Quiz Progress</a></li>
              <li class="nav-item">
                <a class="nav-link" href="{% url 'student' %}#progress-chart">
                  <i class="bi bi-bar-chart-line"></i> My Progress
                </a>
              </li>
              
      
            {% elif user.role == 'trainer' %}
              <li class="nav-item"><a class="nav-link" href="{% url 'trainer_students' %}"><i class="bi bi-people"></i> My Students</a></li>
              
              
              <li class="nav-item"><a class="nav-link" href="{% url 'trainer_video_list' %}"><i class="bi bi-collection-play"></i> My Videos</a></li>
              <li class="nav-item"><a class="nav-link" href="{% url 'trainer_student_progress' %}"><i class="bi bi-person-lines-fill"></i> Student Progress</a></li>
              <li class="nav-item"><a class="nav-link" href="{% url 'student_progress_report' %}"><i class="bi bi-people"></i> Student Reports</a></li>
              <li class="nav-item">
                <a class="nav-link" href="{% url 'create_quiz' %}">
                  <i class="bi bi-plus-square"></i> Create Quiz
                </a>
              </li>
              
              <li class="nav-item"><a class="nav-link" href="{% url 'trainer_quiz_dashboard' %}"><i class="bi bi-graph-up"></i> Quiz Performance</a></li>
              <li class="nav-item"><a class="nav-link" href="{% url 'trainer_courses' %}"><i class="bi bi-journal-check"></i> My Courses</a></li>

              
              <li class="nav-item"><a class="nav-link" href="{% url 'trainer_feedback' %}"><i class="bi bi-chat-dots"></i> Video Feedback</a></li>
              {% comment %} <li class="nav-item"><a class="nav-link" href="{% url 'trainer_video_feedback' %}"><i class="bi bi-chat-square-quote"></i> Your Video Feedback</a></li> {% endcomment %}
      
            {% elif user.role == 'manager' %}
              <li class="nav-item"><a class="nav-link" href="{% url 'manager' %}"><i class="bi bi-speedometer2"></i> Dashboard</a></li>
              <li class="nav-item"><a class="nav-link" href="{% url 'all_feedback' %}"><i class="bi bi-chat-left-text"></i> Feedback</a></li>
              <li class="nav-item"><a class="nav-link" href="{% url 'all_purchases' %}"><i class="bi bi-receipt"></i> Purchases</a></li>
              <li class="nav-item"><a class="nav-link" href="{% url 'student_progress' %}"><i class="bi bi-bar-chart-line"></i> Progress</a></li>
              
              
              <li class="nav-item"><a class="nav-link" href="{% url 'manager_course_ratings' %}"><i class="bi bi-bar-chart-line"></i> Course Analytics</a></li>
              <li class="nav-item"><a class="nav-link" href="{% url 'manager_quiz_dashboard' %}"><i class="bi bi-clipboard-data"></i> Quiz Analytics</a></li>
              <li class="nav-item"><a class="nav-link" href="{% url 'manager_quiz_list' %}"><i class="bi bi-question-circle-fill"></i> Manage Quizzes</a></li>
              <li class="nav-item">
                {% for quiz in quizzes %}
  <a href="{% url 'quiz_summary' quiz.id %}">üìä {{ quiz.title }}</a>
{% endfor %}



              </li>
              


              <li class="nav-item">
                <a class="nav-link" href="{% url 'manage_courses' %}">
                  <i class="bi bi-person-badge"></i> Manage Courses
                </a>
              </li>
              
              <li class="nav-item"><a class="nav-link" href="{% url 'assign_trainer' %}"><i class="bi bi-person-check"></i> Assign Trainer</a></li>
              <li class="nav-item"><a class="nav-link" href="{% url 'manager_feedback' %}"><i class="bi bi-chat-dots"></i> Student Feedback</a></li>
              <li class="nav-item"><a class="nav-link" href="{% url 'feedback_charts' %}"><i class="bi bi-pie-chart"></i> Feedback Charts</a></li>
              <li class="nav-item"><a class="nav-link" href="{% url 'feedback_timeline' %}"><i class="bi bi-graph-up"></i> Rating Timeline</a></li>
              <li class="nav-item"><a class="nav-link" href="{% url 'trainer_performance' %}"><i class="bi bi-bar-chart-steps"></i> Trainer Performance</a></li>
              <li class="nav-item"><a class="nav-link" href="{% url 'low_rated_trainers' %}"><i class="bi bi-exclamation-triangle"></i> Low Ratings</a></li>
              <li class="nav-item"><a class="nav-link" href="{% url 'student_progress_report' %}"><i class="bi bi-bar-chart-line"></i> Progress Report</a></li>
              <li class="nav-item"><a class="nav-link" href="{% url 'manage_student_progress' %}"><i class="bi bi-arrow-counterclockwise"></i> Reset Progress</a></li>
            {% endif %}
          </ul>
      
          <!-- Footer -->
          <div class="footer mt-4">
            <p class="small text-muted text-center">
              &copy; <script>document.write(new Date().getFullYear());</script> ELMS | Built with ‚ù§Ô∏è by Rohith
            </p>
          </div>
      
        </div>
      </nav>
      

      <!-- Page Content -->
      <div id="content" class="p-4 p-md-5">
        <!-- Top Navbar -->
       <!-- Top Navbar -->
<nav class="navbar navbar-expand-lg navbar-light bg-light">
  <div class="container-fluid">

    <!-- Sidebar Toggle Button -->
    <button type="button" id="sidebarCollapse" class="btn btn-primary">
      <i class="fa fa-bars"></i>
      <span class="sr-only">Toggle Menu</span>
    </button>

    <!-- Responsive Mobile Toggle -->
    <button class="btn btn-dark d-inline-block d-lg-none ml-auto"
            type="button"
            data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent"
            aria-expanded="false"
            aria-label="Toggle navigation">
      <i class="fa fa-bars"></i>
    </button>

    <!-- Collapsible Area (Right Side: User Info) -->
    <div class="collapse navbar-collapse justify-content-end" id="navbarSupportedContent">
      <ul class="nav navbar-nav ml-auto">

        <!-- üîπ Add Static Menu Links Here -->
        <li class="nav-item">
          {% if user.is_authenticated %}
            {% if user.is_student %}
              <a class="nav-link" href="{% url 'student' %}">Home</a>
            {% elif user.is_trainer %}
              <a class="nav-link" href="{% url 'trainer' %}">Home</a>
            {% elif user.is_manager %}
              <a class="nav-link" href="{% url 'manager' %}">Home</a>
            {% endif %}
          {% else %}
            <a class="nav-link" href="{% url 'home' %}">Home</a>  {# Default home for anonymous users #}
          {% endif %}
        </li>
        
    <li class="nav-item"><a class="nav-link" href="#">About</a></li>

        {% if user.is_authenticated %}
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle d-flex align-items-center" href="#" id="userDropdown" role="button"
             data-bs-toggle="dropdown" aria-expanded="false">

            {% if user.is_student and user.studentprofile.profile_pic %}
              <img src="{{ user.studentprofile.profile_pic.url }}" class="rounded-circle me-2" width="32" height="32" alt="Student">
            {% elif user.is_trainer and user.trainerprofile.profile_pic %}
              <img src="{{ user.trainerprofile.profile_pic.url }}" class="rounded-circle me-2" width="32" height="32" alt="Trainer">
            {% else %}
              <i class="bi bi-person-circle me-2" style="font-size: 1.4rem;"></i>
            {% endif %}

            {{ user.username }}
          </a>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdown">
            {% if user.is_student %}
              <li><a class="dropdown-item" href="{% url 'edit_student_profile' %}"><i class="bi bi-person-lines-fill me-2"></i> Edit Profile</a></li>
              <li><a class="dropdown-item" href="{% url 'student_password_change' %}"><i class="bi bi-key me-2"></i> Change Password</a></li>
            {% elif user.is_trainer %}
              <li><a class="dropdown-item" href="{% url 'edit_trainer_profile' %}"><i class="bi bi-pencil-square me-2"></i> Edit Profile</a></li>
            {% endif %}
            <li><hr class="dropdown-divider"></li>
            <li><a class="dropdown-item" href="{% url 'logout' %}"><i class="bi bi-box-arrow-right me-2"></i> Logout</a></li>
          </ul>
        </li>
        {% endif %}

      </ul>
    </div>

  </div>
</nav>


        <!-- Dynamic Content -->
{% block content %}
{% if messages %}
  <div class="container mt-3">
    {% for message in messages %}
      <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
        {{ message }}
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>
    {% endfor %}
  </div>
{% endif %}

<!-- Child template content goes here -->
{% endblock %}


      </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script src="{% static 'js/jquery.min.js' %}"></script>
    <script src="{% static 'js/popper.js' %}"></script>
    <script src="{% static 'js/bootstrap.min.js' %}"></script>
    <script src="{% static 'js/main.js' %}"></script>

    {% block js %}{% endblock %}
  </body>
</html>
